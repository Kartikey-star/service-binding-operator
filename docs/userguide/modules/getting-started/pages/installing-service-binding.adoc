= Installing Service Binding Operator

The Service Binding Operator can be installed on the following version
of Kubernetes and OpenShift:

* xref:#installing-on-kubernetes[Kubernetes
version 1.19 or above].
* xref:#installing-the-service-binding-operator-from-the-openshift-container-platform-web-ui[OpenShift
version 4.6 or above].

[#installing-on-kubernetes]
== Installing on Kubernetes

You can install the Service Binding Operator using the following
methods:

. Installing the Service Binding Operator using OLM
.. Go to
https://operatorhub.io/operator/service-binding-operator[OperatorHub.io].
.. Click on the blue btn:[Install] button.
.. Follow the instructions to install the Service Binding Operator.
. Installing the Service Binding Operator using Helm chart
. Installing the Service Binding Operator without OLM
If you do not have Operator Lifecycle Manager, you can install the
Operator using the released resources.

[source,bash]
....
kubectl apply -f https://github.com/redhat-developer/service-binding-operator/releases/latest/download/release.yaml
....


[#installing-the-service-binding-operator-from-the-openshift-container-platform-web-ui]
== Installing the Service Binding Operator from the OpenShift Container Platform web UI

Prerequisites:

. https://docs.openshift.com/container-platform/4.8/welcome/index.html[Red
Hat OpenShift Container Platform] installed.

. Navigate in the web console to the OperatorHub page and type `Service
Binding` into the `Filter by keyword` box:
+
image:ocp_operathub.png[ocp_operathub]

. Click *Service Binding Operator* from the result. A page to install
the Operator is displayed with additional information about the
Operator.
+
image:sbo_intall_landing.png[sbo_intall_landing]

. Click btn:[Install]. The Install Operator page is displayed.
. Select the options as per your requirements and click btn:[Install]. After
the installation is complete, a page with the *Installed Operator â€“
ready for use* message is displayed.
+
image:sbo_install_options.png[sbo_install_options]

. Click btn:[View Operator]. The *Service Binding Operator* page is
displayed with the Operator details.
+
image:sbo_post_install.png[sbo_post_install]

[#installing-the-service-binding-operator-from-the-service-binding-operator-helm-chart]
== Installing the service binding operator from the service binding operator helm chart

The helm chart installation involves the following steps:

. Add the helm chart repository
. Install the chart
. Test the chart

Note: If service binding operator is not installed through OLM, the operator requires that cert-manager is available on the cluster. It can be installed by:
[source,bash]
....
kubectl apply -f https://github.com/jetstack/cert-manager/releases/download/v1.6.0/cert-manager.yaml
....

[## Add the helm chart repository]
== Add the helm chart repository
You need to add our helm repository to your local repository. Name the repository as per your convenience.  

[source,bash]
....
helm repo add service-binding-operator https://redhat-developer.github.io/service-binding-operator-helm-chart/
....

[## Install the helm chart]
== Install the helm chart

[source,bash]
....
helm install service-binding-operator https://redhat-developer.github.io/service-binding-operator-helm-chart/service-binding-operator
....

Alternatively you can search the repository in local machine and install the chart.
[source,bash]
....
helm search repo  service-binding-operator
....

After you have searched for the chart you can install the chart using 

[source,bash]
....
helm install service-binding-operator https://redhat-developer.github.io/service-binding-operator-helm-chart/service-binding-operator
....


You can check whether the chart is succesfully installed by running the following command

[source,bash]
....
kubectl get pods -n service-binding-operator
....

[## Test the  chart]
== Test the chart 
We also provide the facility to run smoke test on service binding operator release as a helm test. 
In order to test the chart the user is expected to create a secret (specify the namespace if applicable), named my-k-config from his kubeconfig .

NOTE:
In case you are installing the chart on AWS eks cluster then you need to modify the aws-auth configmap.
```
kubectl edit -n kube-system cm/aws-auth 
```
Please add -system:masters to mapRoles and save.
After editing the config map you need to update the eks kubeconfig
```
aws eks update-kubeconfig --name <cluster-name>
```
Then Continue with the following steps.

```
kubectl create secret generic my-k-config --from-file=<PATH to your kubeconfig>
```

Run the helm test (specify the namespace if applicable) using :

```
helm test service-binding-operator
```

Please ensure to delete the secret (specify the namespace if applicable) created :
```
kubectl delete secret my-k-config
```